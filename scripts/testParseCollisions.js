// testParseCollisions.js
const { parseCollisionSpheres } = require('../src/utils/ParseCollisions');

const input = {
    "fp3_link0::meshes/robot_arms/fp3/collision/link0.stl": {
        "8": {
            "0": {
                "mean": 623.871,
                "best": 623.871,
                "worst": 623.871,
                "spheres": [
                    {
                        "origin": [
                            -0.043840850344896314,
                            -0.0020266542661190033,
                            0.058728169520805354
                        ],
                        "radius": 0.12913
                    }
                ]
            },
            "1": {
                "mean": 440.712,
                "best": 424.675,
                "worst": 456.75,
                "spheres": [
                    {
                        "origin": [
                            -0.007589850344896315,
                            4.83457338809967e-05,
                            0.06997916952080535
                        ],
                        "radius": 0.117911
                    },
                    {
                        "origin": [
                            -0.08190085034489632,
                            -1.7654266119003296e-05,
                            0.04512316952080536
                        ],
                        "radius": 0.096666
                    }
                ]
            }
        }
    },
    "fp3_link1::meshes/robot_arms/fp3/collision/link1.stl": {
        "8": {
            "0": {
                "mean": 774.607,
                "best": 774.607,
                "worst": 774.607,
                "spheres": [
                    {
                        "origin": [
                            0.005649117776274681,
                            -0.026875439349412916,
                            -0.0729174888778925
                        ],
                        "radius": 0.145027
                    }
                ]
            },
            "1": {
                "mean": 288.963,
                "best": 272.379,
                "worst": 305.547,
                "spheres": [
                    {
                        "origin": [
                            3.117776274681096e-06,
                            -0.04853843934941292,
                            -0.019277488877892497
                        ],
                        "radius": 0.088604
                    },
                    {
                        "origin": [
                            7.61177762746811e-05,
                            -0.0046444393494129155,
                            -0.12118248887789249
                        ],
                        "radius": 0.092714
                    }
                ]
            }
        }
    },
    "fp3_link2::meshes/robot_arms/fp3/collision/link2.stl": {
        "8": {
            "0": {
                "mean": 764.203,
                "best": 764.203,
                "worst": 764.203,
                "spheres": [
                    {
                        "origin": [
                            0.004475746971964836,
                            -0.07439476728439331,
                            0.02750136611640453
                        ],
                        "radius": 0.145698
                    }
                ]
            },
            "1": {
                "mean": 204.469,
                "best": 179.566,
                "worst": 225.379,
                "spheres": [
                    {
                        "origin": [
                            -6.325302803516388e-05,
                            -0.1374107672843933,
                            0.0027253661164045317
                        ],
                        "radius": 0.080952
                    },
                    {
                        "origin": [
                            7.469719648361267e-07,
                            -0.05252276728439331,
                            0.041859366116404534
                        ],
                        "radius": 0.083055
                    },
                    {
                        "origin": [
                            2.4746971964836127e-05,
                            -0.0018717672843933109,
                            0.052315366116404534
                        ],
                        "radius": 0.077314
                    }
                ]
            }
        }
    },
    "fp3_link3::meshes/robot_arms/fp3/collision/link3.stl": {
        "8": {
            "0": {
                "mean": 728.447,
                "best": 728.447,
                "worst": 728.447,
                "spheres": [
                    {
                        "origin": [
                            0.03614873313939571,
                            0.025433908588051796,
                            -0.04203554923415184
                        ],
                        "radius": 0.127892
                    }
                ]
            },
            "1": {
                "mean": 284.243,
                "best": 272.034,
                "worst": 296.452,
                "spheres": [
                    {
                        "origin": [
                            0.006183733139395714,
                            0.0035159085880517964,
                            -0.06696854923415184
                        ],
                        "radius": 0.082522
                    },
                    {
                        "origin": [
                            0.07220373313939571,
                            0.037084908588051795,
                            -0.012488549234151842
                        ],
                        "radius": 0.083681
                    }
                ]
            }
        }
    },
    "fp3_link4::meshes/robot_arms/fp3/collision/link4.stl": {
        "8": {
            "0": {
                "mean": 766.851,
                "best": 766.851,
                "worst": 766.851,
                "spheres": [
                    {
                        "origin": [
                            -0.04417066810381413,
                            0.048143879859089855,
                            0.028557743931412697
                        ],
                        "radius": 0.128563
                    }
                ]
            },
            "1": {
                "mean": 288.69,
                "best": 285.433,
                "worst": 291.948,
                "spheres": [
                    {
                        "origin": [
                            -0.014181668103814125,
                            0.012089879859089853,
                            0.037441743931412697
                        ],
                        "radius": 0.085393
                    },
                    {
                        "origin": [
                            -0.07645166810381412,
                            0.06969487985908984,
                            0.003339743931412696
                        ],
                        "radius": 0.08244
                    }
                ]
            }
        }
    },
    "fp3_link5::meshes/robot_arms/fp3/collision/link5.stl": {
        "8": {
            "0": {
                "mean": 809.054,
                "best": 809.054,
                "worst": 809.054,
                "spheres": [
                    {
                        "origin": [
                            0.005074441931009293,
                            0.02247517572593689,
                            -0.10337702466511726
                        ],
                        "radius": 0.174343
                    }
                ]
            },
            "1": {
                "mean": 154.066,
                "best": 136.993,
                "worst": 166.44,
                "spheres": [
                    {
                        "origin": [
                            2.441931009292601e-06,
                            0.0039791757259368885,
                            -0.20816602466511724
                        ],
                        "radius": 0.077989
                    },
                    {
                        "origin": [
                            3.84419310092926e-05,
                            0.03274317572593689,
                            -0.14507302466511726
                        ],
                        "radius": 0.078055
                    },
                    {
                        "origin": [
                            5.2441931009292604e-05,
                            0.05023517572593689,
                            -0.06486402466511726
                        ],
                        "radius": 0.077221
                    },
                    {
                        "origin": [
                            5.94419310092926e-05,
                            0.061682175725936886,
                            -0.0015150246651172705
                        ],
                        "radius": 0.070995
                    }
                ]
            }
        }
    },
    "fp3_link6::meshes/robot_arms/fp3/collision/link6.stl": {
        "8": {
            "0": {
                "mean": 627.569,
                "best": 627.569,
                "worst": 627.569,
                "spheres": [
                    {
                        "origin": [
                            0.0490293105660677,
                            0.0002512107896804807,
                            0.005257786615848541
                        ],
                        "radius": 0.099234
                    }
                ]
            },
            "1": {
                "mean": 590.276,
                "best": 590.276,
                "worst": 590.276,
                "spheres": [
                    {
                        "origin": [
                            0.04832831056606769,
                            0.00040121078968048153,
                            0.00887378661584854
                        ],
                        "radius": 0.099253
                    }
                ]
            }
        }
    },
    "fp3_link7::meshes/robot_arms/fp3/collision/link7.stl": {
        "8": {
            "0": {
                "mean": 889.661,
                "best": 889.661,
                "worst": 889.661,
                "spheres": [
                    {
                        "origin": [
                            0.012984770305991173,
                            0.013310847870230675,
                            0.08915687966275215
                        ],
                        "radius": 0.073398
                    }
                ]
            },
            "1": {
                "mean": 410.535,
                "best": 399.551,
                "worst": 421.519,
                "spheres": [
                    {
                        "origin": [
                            -0.0006062296940088259,
                            -0.0005891521297693263,
                            0.07939987966275215
                        ],
                        "radius": 0.053815
                    },
                    {
                        "origin": [
                            0.03402277030599117,
                            0.03414484787023067,
                            0.08080787966275216
                        ],
                        "radius": 0.048047
                    }
                ]
            }
        }
    },
    "fp3_hand::meshes/robot_ee/franka_hand_black/collision/hand.stl": {
        "8": {
            "0": {
                "mean": 767.868,
                "best": 767.868,
                "worst": 767.868,
                "spheres": [
                    {
                        "origin": [
                            -0.0005760675970315933,
                            -0.0004509218337535859,
                            0.021754674433231355
                        ],
                        "radius": 0.107939
                    }
                ]
            },
            "1": {
                "mean": 211.08,
                "best": 201.973,
                "worst": 214.735,
                "spheres": [
                    {
                        "origin": [
                            9.193240296840668e-05,
                            0.07441707816624642,
                            0.027520674433231355
                        ],
                        "radius": 0.044394
                    },
                    {
                        "origin": [
                            2.5932402968406678e-05,
                            0.033791078166246415,
                            0.023450674433231355
                        ],
                        "radius": 0.048978
                    },
                    {
                        "origin": [
                            1.9324029684066776e-06,
                            -0.0068179218337535855,
                            0.020964674433231353
                        ],
                        "radius": 0.050352
                    },
                    {
                        "origin": [
                            7.293240296840668e-05,
                            -0.06114992183375358,
                            0.039945674433231354
                        ],
                        "radius": 0.044425
                    },
                    {
                        "origin": [
                            1.6932402968406676e-05,
                            -0.06272592183375358,
                            0.006249674433231354
                        ],
                        "radius": 0.043995
                    }
                ]
            }
        }
    }
};

const parsed = parseCollisionSpheres(input);
console.log(JSON.stringify(parsed, null, 2));
